searchByAuthor :: w:World -> a:User -> World
searchByAuthor = \w . \a . 
    let u = getSessionUser w in
    
    let isAuthor = \pid . liftM
                            (elem a) (bind (downgrade (bind
                                                         (getChair w) (\x7 .
                                                           bind u (\x6 . return
                                                                           (eq
                                                                              x7
                                                                              x6)))))
                                        (\g0 . bind (downgrade (bind
                                                                  (getCurrentPhase
                                                                     w) (\x11 .
                                                                    return (leq
                                                                              rebuttal
                                                                              x11))))
                                                 (\g1 . 
                                                   if g0 || g1
                                                     then getPaperAuthors w pid
                                                     else return Nil))) in
    
    let out = bind (getAllPaperIds
                      w) (\pids . bind (filterM
                                          isAuthor pids) (\myPids . bind
                                                                      (mapM
                                                                         (getPaperTitle
                                                                            w)
                                                                         myPids)
                                                                      (\myTitles .
                                                                        foldM
                                                                          (\x .
                                                                            \y .
                                                                              return
                                                                                (strcat
                                                                                   x
                                                                                   y))
                                                                          emptyString
                                                                          myTitles)))
      in
    print w u out

(Goals: 1)
(Measures: 4)
(Policy size: fromList [("4-Search.sq",33),("Prelude.sq",46),("Tagged.sq",123)])
Goal                  &     Templ  &  Solution  &   Time: Typecheck  &     Repair  &    Recheck  &  Total Synth  \\
searchByAuthor        &        69  &       123  &             0.06s  &      0.76s  &      0.08s  &        0.92s  \\
Totals                &        69  &       123  &             0.06s  &      0.76s  &      0.08s  &        0.92s  \\
