sortPapersByScore :: w:World -> World
sortPapersByScore = \w . 
  let u = getSessionUser w in
  
  let cmpScore = \pid1 . \pid2 .
        bind (bind (downgrade (bind u
                                 (\x9 . bind (getPaperConflicts w
                                                pid1) (\x8 . return (not (elem
                                                                            x9
                                                                            x8))))))
                (\g0 . 
                  if g0
                    then getPaperScore w pid1
                    else return zero)) (\x1 . bind
                                                (bind (downgrade (bind u (\x19 .
                                                                      bind
                                                                        (getPaperConflicts
                                                                           w
                                                                           pid2)
                                                                        (\x18 .
                                                                          return
                                                                            (not
                                                                               (elem
                                                                                  x19
                                                                                  x18))))))
                                                   (\g1 . 
                                                     if g1
                                                       then getPaperScore w pid2
                                                       else return zero)) (\x2 .
                                                  return (x1 <= x2))) in
  
  let out = bind (getAllPaperIds
                    w) (\pids . bind (sortByM
                                        cmpScore pids) (\sortedPids .
                                    bind (mapM (getPaperTitle w)
                                            sortedPids) (\titles . foldM
                                                                     (\x . \y .
                                                                         return
                                                                           (strcat
                                                                              x
                                                                              y))
                                                                     emptyString
                                                                     titles)))
    in
  print w u out

(Goals: 1)
(Measures: 4)
(Policy size: fromList [("5-Sort.sq",28),("Prelude.sq",46),("Tagged.sq",123)])
Goal                  &     Templ  &  Solution  &   Time: Typecheck  &     Repair  &    Recheck  &  Total Synth  \\
sortPapersByScore     &        83  &       151  &             0.07s  &      0.63s  &      0.04s  &        0.75s  \\
Totals                &        83  &       151  &             0.07s  &      0.63s  &      0.04s  &        0.75s  \\
