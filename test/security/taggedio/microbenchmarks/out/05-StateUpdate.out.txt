setIfNothing :: <p :: World -> User -> Bool> . x:Int -> m:Maybe Tagged Int <p> -> {Maybe Tagged Int <p>|just _v}
setIfNothing = \x . \m . maybe
                           (Just (return x)) (\y . Just y)
                           m

placeBid :: arg2:World -> arg1:User -> arg0:Int -> World
placeBid = \w . \client . \b . 
      let showParticipant = \p . do
                                   mB <- do
                                           g0 <- downgrade (return (eq
                                                                      client p))
                                           g1 <- downgrade (do
                                                              x65 <- getPhase w
                                                              return (eq Done
                                                                        x65))
                                           
                                           if g0 || g1
                                             then getBid w p
                                             else do
                                                    x4 <- getBid w p
                                                    return (fmap x4 (\x2 .
                                                                return zero))
                                   maybe (return emptyString) (\x .
                                       liftM show x) mB in
      
      let out = liftM unlines (mapM
                                 showParticipant
                                 (getAllParticipants w)) in
      
      let newBid = do
                     mB <- getBid w client
                     return (setIfNothing b mB) in
      
      let w' = setBid w client newBid
        in
      print w' (return client) out

(Goals: 2)
(Measures: 4)
(Policy size: fromList [("../Prelude.sq",46),("../Tagged.sq",110),("05-StateUpdate.sq",71)])
Goal                  &     Templ  &  Solution  &   Time: Typecheck  &     Repair  &    Recheck  &  Total Synth  \\
setIfNothing          &        16  &        16  &             0.00s  &      0.00s  &      0.00s  &        0.00s  \\
placeBid              &        74  &       132  &             0.07s  &      0.67s  &      0.04s  &        0.79s  \\
Totals                &        90  &       148  &             0.08s  &      0.67s  &      0.04s  &        0.79s  \\
