data RecordId
data Record

getSessionUser :: TaggedIO User <{True}>

predicate record :: RecordId -> Record
getRecord :: rid:RecordId -> TaggedIO (Tagged {Record | _v == record rid} <{True}>) <{True}>

predicate author :: Record -> User
getAuthor :: r:Record -> Tagged {User | _v == author r} <{True}>

predicate title :: Record -> String
getTitle :: r:Record -> Tagged {String | _v == title r} <{_0 == author r}>

showRecordByIdView :: rid:RecordId -> TaggedIO Unit <{True}>
showRecordByIdView = \rid .
  bindIO (getSessionUser) (\u .
  bindIO (getRecord rid) (\record .
  let author {- Tagged User -} = bind record (\r . getAuthor r) in
  let isOk {- Tagged Bool -} = bind author (\a . return (u == a)) in
  let title {- Tagged String -} = bind record (\r . getTitle r) in
  ifIO_ isOk
    (print (return u) title)
    (returnIO Unit)
  ))

-- (print ...) :: TaggedIO Unit {a}
-- record :: Tagged Record {b}
-- (ifIO ...) :: TaggedIO Ubit {c}

-- True ==> c(_0)

-- c(_0) ==> t(_0)

-- (u == author (record rid)) ==> b
-- t(_0) and b ==> a(_0)

-- u == _v ==> pp(_v)
-- a(_0) ==> pp(_0)

-- pp(_0) ==> b(_0)

-- b(_0) ==> (_0 == author (record rid))

-- error message
-- (u == author (record rid)) || _0 == u
